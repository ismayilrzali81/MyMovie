"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[130],{130:(e,t,i)=>{i.r(t),i.d(t,{favorite_btn:()=>s});var a=i(669),o=i.n(a),r=i(427),l=i(956);const s=e=>{let t=document.querySelectorAll("section"),i=(0,r.getAuth)(),a=document.querySelector("section.featured_movie .movie_list"),s=document.querySelector(".featured_movie"),n=(0,l.getDatabase)(),d=[];const c=(e,t)=>{t.forEach(((t,i)=>{0!=i&&2!=i&&4!=i&&t.querySelectorAll(".movie_list_item").forEach((t=>{t.getAttribute("data-id")===e&&t.querySelector(".favorite_toggle_btn").classList.remove("favorite_toggle_btn_favorite")}))}))};t.forEach(((e,r)=>{0!=r&&4!=r&&e.addEventListener("click",(async e=>{let r=e.target;if(r.classList.contains("favorite_toggle_btn")&&!r.classList.contains("favorite_toggle_btn_favorite"))if(i.currentUser){const e=(await(0,l.get)((0,l.ref)(n,"favorite/"+i.currentUser.uid))).val();d=e?e.movies_info:[],d.push({id:r.parentElement.parentElement.getAttribute("data-id"),clazz:!0}),(0,l.update)((0,l.ref)(n,"favorite/"+i.currentUser.uid),{movies_info:d}),r.classList.add("favorite_toggle_btn_favorite"),console.log(d),"none"==s.style.display&&(s.style.display="block")}else alert("you are not logged in.");else if(r.classList.contains("favorite_toggle_btn_favorite")){const e=(await(0,l.get)((0,l.ref)(n,"favorite/"+i.currentUser.uid))).val();d=e?e.movies_info:[],d.length>1?(d.forEach(((e,t)=>{e.id===r.parentElement.parentElement.getAttribute("data-id")&&(d.splice(t,1),a.querySelectorAll(".movie_list_item")[t].remove())})),c(r.parentElement.parentElement.getAttribute("data-id"),t)):(d.shift(),a.querySelector(".movie_list_item").remove(),c(r.parentElement.parentElement.getAttribute("data-id"),t),s.style.cssText="display:none"),r.classList.remove("favorite_toggle_btn_favorite"),(0,l.update)((0,l.ref)(n,"favorite/"+i.currentUser.uid),{movies_info:d})}r.classList.contains("favorite_toggle_btn")&&d.length>0&&(async e=>{e:for(let t of e){if(a.querySelectorAll(".movie_list_item"))for(let e of a.querySelectorAll(".movie_list_item"))if(e.getAttribute("data-id")==t.id)continue e;let e=t.clazz?"favorite_toggle_btn favorite_toggle_btn_favorite":"favorite_toggle_btn";const i=await o().get(`http://www.omdbapi.com/?apikey=8d9cfe3d&i=${t.id}`);a.innerHTML+=`<div class="movie_list_item" data-id="${t.id}">\n                            <div class="photo_wrapper">\n                                <img loading='lazy' src='${"https://res.cloudinary.com/dfohwxch2//image/fetch/q_80,f_auto/"+i.data.Poster.slice(0,-3)+"webp"}' alt="movie photo">\n                                <div class='${e}'></div>\n                            </div>\n            \n                            <div class="year">${i.data.Year}</div>\n                            <div class="title">${i.data.Title}</div>\n                            <div class="score">\n                                <div class="imdb_score"> <img loading='lazy'  class="imdb" alt="imdb">${i.data.imdbRating?i.data.imdbRating:0}/ 100</div>\n                            </div>\n                            <div class="genre">${i.data.Genre}</div>\n                        </div>`}})(d)}))}))}}}]);