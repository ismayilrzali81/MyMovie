"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[130],{130:(e,t,i)=>{i.r(t),i.d(t,{favorite_btn:()=>a});var t=i(669),v=i.n(t),c=i(427),_=i(956);const a=e=>{let a=document.querySelectorAll("section"),o=(0,c.getAuth)(),r=document.querySelector("section.featured_movie .movie_list"),l=document.querySelector(".featured_movie"),s=(0,_.getDatabase)(),n=[];const d=(i,e)=>{e.forEach((e,t)=>{0!=t&&2!=t&&4!=t&&e.querySelectorAll(".movie_list_item").forEach(e=>{e.getAttribute("data-id")===i&&e.querySelector(".favorite_toggle_btn").classList.remove("favorite_toggle_btn_favorite")})})};a.forEach((e,t)=>{0!=t&&4!=t&&e.addEventListener("click",async e=>{let i=e.target;var t,e=o.currentUser.uid;i.classList.contains("favorite_toggle_btn")&&!i.classList.contains("favorite_toggle_btn_favorite")?o.currentUser?(t=(await(0,_.get)((0,_.ref)(s,"favorite/"+e))).val(),(n=t?t.movies_info:[]).push({id:i.parentElement.parentElement.getAttribute("data-id"),clazz:!0}),(0,_.update)((0,_.ref)(s,"favorite/"+e),{movies_info:n}),i.classList.add("favorite_toggle_btn_favorite"),console.log(n),"none"==l.style.display&&(l.style.display="block")):alert("you are not logged in."):i.classList.contains("favorite_toggle_btn_favorite")&&(t=(await(0,_.get)((0,_.ref)(s,"favorite/"+e))).val(),1<(n=t?t.movies_info:[]).length?(n.forEach((e,t)=>{e.id===i.parentElement.parentElement.getAttribute("data-id")&&(n.splice(t,1),r.querySelectorAll(".movie_list_item")[t].remove())}),d(i.parentElement.parentElement.getAttribute("data-id"),a)):(n.shift(),r.querySelector(".movie_list_item").remove(),d(i.parentElement.parentElement.getAttribute("data-id"),a),l.style.cssText="display:none"),i.classList.remove("favorite_toggle_btn_favorite"),(0,_.update)((0,_.ref)(s,"favorite/"+e),{movies_info:n})),i.classList.contains("favorite_toggle_btn")&&0<n.length&&(async e=>{e:for(var t of e){if(r.querySelectorAll(".movie_list_item"))for(var i of r.querySelectorAll(".movie_list_item"))if(i.getAttribute("data-id")==t.id)continue e;var a=t.clazz?"favorite_toggle_btn favorite_toggle_btn_favorite":"favorite_toggle_btn",o=await v().get("http://www.omdbapi.com/?apikey=8d9cfe3d&i="+t.id);r.innerHTML+=`<div class="movie_list_item" data-id="${t.id}">
                            <div class="photo_wrapper">
                                <img loading='lazy' src='${o.data.Poster}' alt="movie photo">
                                <div class='${a}'></div>
                            </div>
            
                            <div class="year">${o.data.Year}</div>
                            <div class="title">${o.data.Title}</div>
                            <div class="score">
                                <div class="imdb_score"> <img loading='lazy'  class="imdb" alt="imdb">${o.data.imdbRating||0}/ 100</div>
                            </div>
                            <div class="genre">${o.data.Genre}</div>
                        </div>`}})(n)})})}}}]);