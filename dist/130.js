"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[130],{130:(e,t,i)=>{i.r(t),i.d(t,{favorite_btn:()=>n});var a=i(669),o=i.n(a),l=i(427),r=i(956);const n=e=>{let t=document.querySelectorAll("section"),i=(0,l.getAuth)(),a=document.querySelector("section.featured_movie .movie_list"),n=document.querySelector(".featured_movie"),s=(0,r.getDatabase)(),d=[];const c=(e,t)=>{t.forEach(((t,i)=>{0!=i&&2!=i&&4!=i&&t.querySelectorAll(".movie_list_item").forEach((t=>{t.getAttribute("data-id")===e&&t.querySelector(".favorite_toggle_btn").classList.remove("favorite_toggle_btn_favorite")}))}))};t.forEach(((e,l)=>{0!=l&&4!=l&&e.addEventListener("click",(async e=>{let l=e.target,v=i.currentUser.uid;if(l.classList.contains("favorite_toggle_btn")&&!l.classList.contains("favorite_toggle_btn_favorite"))if(i.currentUser){const e=(await(0,r.get)((0,r.ref)(s,"favorite/"+v))).val();d=e?e.movies_info:[],d.push({id:l.parentElement.parentElement.getAttribute("data-id"),clazz:!0}),(0,r.update)((0,r.ref)(s,"favorite/"+v),{movies_info:d}),l.classList.add("favorite_toggle_btn_favorite"),console.log(d),"none"==n.style.display&&(n.style.display="block")}else alert("you are not logged in.");else if(l.classList.contains("favorite_toggle_btn_favorite")){const e=(await(0,r.get)((0,r.ref)(s,"favorite/"+v))).val();d=e?e.movies_info:[],d.length>1?(d.forEach(((e,t)=>{e.id===l.parentElement.parentElement.getAttribute("data-id")&&(d.splice(t,1),a.querySelectorAll(".movie_list_item")[t].remove())})),c(l.parentElement.parentElement.getAttribute("data-id"),t)):(d.shift(),a.querySelector(".movie_list_item").remove(),c(l.parentElement.parentElement.getAttribute("data-id"),t),n.style.cssText="display:none"),l.classList.remove("favorite_toggle_btn_favorite"),(0,r.update)((0,r.ref)(s,"favorite/"+v),{movies_info:d})}l.classList.contains("favorite_toggle_btn")&&d.length>0&&(async e=>{e:for(let t of e){if(a.querySelectorAll(".movie_list_item"))for(let e of a.querySelectorAll(".movie_list_item"))if(e.getAttribute("data-id")==t.id)continue e;let e=t.clazz?"favorite_toggle_btn favorite_toggle_btn_favorite":"favorite_toggle_btn";const i=await o().get(`http://www.omdbapi.com/?apikey=8d9cfe3d&i=${t.id}`);a.innerHTML+=`<div class="movie_list_item" data-id="${t.id}">\n                            <div class="photo_wrapper">\n                                <img loading='lazy' src='${i.data.Poster}' alt="movie photo">\n                                <div class='${e}'></div>\n                            </div>\n            \n                            <div class="year">${i.data.Year}</div>\n                            <div class="title">${i.data.Title}</div>\n                            <div class="score">\n                                <div class="imdb_score"> <img loading='lazy'  class="imdb" alt="imdb">${i.data.imdbRating?i.data.imdbRating:0}/ 100</div>\n                            </div>\n                            <div class="genre">${i.data.Genre}</div>\n                        </div>`}})(d)}))}))}}}]);